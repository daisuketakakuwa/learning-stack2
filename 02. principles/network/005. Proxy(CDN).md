## CDNã¯ã€ŒReverseProxyã®1ç¨®ã€

Forward proxies<br>
Reverse proxies<br>
ãƒ»CDN<br>
ãƒ»Load Balancer<br>

**CDN/Load Balancerã¯ã€Reverse Proxiesã®ä¸€ç¨®ã€‚**

## Special Thanks
ãƒ»[What Is A CDN? How Does It Work?](https://www.youtube.com/watch?v=RI9np1LWzqw)

## ç·æ‹¬
âœ…CDNã¯**é™çš„ãƒªã‚½ãƒ¼ã‚¹ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä»¥å¤–**ã«ã‚‚ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã‹ã‚‰**HTTP trafficã¯å…¨ã¦CDNã‚’çµŒç”±ã•ã›ã‚‹ã¹ã**ã ã€‚ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚ã†ã€‚<br>
âœ…CDNã‚’ä½¿ã†ãƒ¡ãƒªãƒƒãƒˆ/ç›®çš„<br>
ã€€1. reduce the load and bandwidth(å¸¯åŸŸ) requirements of the origin server cluster.<br>
ã€€2. SSL termination at the edge server which reduce the latency to establish an encrypted TCP connectionã€**performance**ã€‘<br>
ã€€3. Protection against the DDoS attackã€**security**ã€‘<br>
ã€€4. Always available even when we have hardware failures for CDNã€**availability**ã€‘

We should be able to make the most of CDN because there are some benefits other than caching static contents.

## What is CDN
ğŸ‘‰**Originally** developed to speed up the delivery of **static HTML content**.<br>
ã€€â†’ **ä»–ã«ã‚‚CDNã‚’ä½¿ã†ç›®çš„/ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã€ã¨ã„ã†ã“ã¨ğŸ‘‰**<br>
ğŸ‘‰ä¸€ç•ªè¿‘ãã«ã‚ã‚‹CDN cacheã€**POP(Point of Presence)**ã€‘ã‚ˆã‚Šé…å¸ƒã™ã‚‹ã€‚<br>
ğŸ‘‰**A server inside POP** is now commonly called **an edge server**.

![](https://storage.googleapis.com/zenn-user-upload/9c02c286a37f-20230102.png)
ğŸ‘‰CDN services
- Amazon CloudFront
- CLOUDFRARE
- Akamai
- Microsoft Azure CDN

ğŸ‘‰Each CDN service use difference technologies to direct a user's request to the closest PoP.<br>
â‘  DNS-based routing<br>
â‘¡ Anycast

### DNS-based routing
ğŸ‘‰å„PoPã¯ä¸€æ„ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã£ã¦ã„ã‚‹ã€‚<br>
ğŸ‘‰CDNã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¦æ±‚â†’DNSã¯ä¸€ç•ªè¿‘ã„PoPã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿”ã—ã¦ãã‚Œã‚‹ã€‚<br>

![](https://storage.googleapis.com/zenn-user-upload/5c71efbd23c7-20230102.png)

### Anycast
ğŸ‘‰å…¨PoPã¯åŒã˜IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã£ã¦ã„ã‚‹ã€‚
ğŸ‘‰IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹â†’ä¸€ç•ªè¿‘ã„PoPã¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã£ã¦ãã‚Œã‚‹ã€‚

## Three benefits to use CDN
### B1. reduce the burden of the origin clusters
Each edge server acts as a **reverse proxy** with a huge content cache.
Whenever there is a cache for the requested content, the origin server don't have to do anything.

![](https://storage.googleapis.com/zenn-user-upload/61f73531623f-20230104.png)

### B2. SSL Terminationã€Performanceã€‘
**ALL TLS connections terminate at the edge server** which reduces the latency to establish an encrypted TCP connection because **TLS handshake are expensive**(take several network round trips to establish). **This is one reason why many modern applications send even dynamic uncacheable HTTP content over the CDN**.<br>
âœ…AWSã ã¨ã€View--HTTPS--CloudFrontã§ã€CloudFront--Originé–“ã¯HTTPã‹HTTPSã§é¸æŠã§ããŸãªã€‚ã“ã‚Œã®ã“ã¨ã ã‚ã€‚

![](https://storage.googleapis.com/zenn-user-upload/99aecc5d6b8b-20230104.png)

### B3. Protection against DDoS attackã€Securityã€‘
Having a network with a capacity much larger than the attackers is the protection for DDoS(Distributed Denial of Services) attack.<br>
âœ…HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å…¥å£ã¨ãªã‚‹ç„é–¢ãŒæ²¢å±±ã‚ã‚‹ã ã‘ã§å…¨ç„¶é•ã†ã€‚LoadBalancerã¯CDNã®EdgeServerã®æ•°ã»ã©ç”¨æ„ã™ã‚‹ã“ã¨ã¯ç¾å®Ÿçš„ã§ã¯ãªã„ã—ã€‚ã€‚

![](https://storage.googleapis.com/zenn-user-upload/d19cd3e1b7bb-20230104.png)
Using Anycast, it allows the CDN to **diffuse the attack traffics over a huge number of servers**. diffuse over(åˆ†æ•£ã™ã‚‹)ã€‚<br>
âœ…ï¼‘ã¤ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦æ”»æ’ƒ -> å„PoPã«åˆ†æ•£ã—ã¦ãã‚Œã‚‹ğŸ‘

![](https://storage.googleapis.com/zenn-user-upload/7ca35e587964-20230104.png)

## B4. Available for the hardware failures
A CDN can withstand many more hardware failures because there are many PoPs.

