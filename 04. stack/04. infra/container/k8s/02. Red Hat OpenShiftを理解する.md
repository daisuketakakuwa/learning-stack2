# ã¾ãˆãŒã
ç¾åœ¨ç§ãŒé–‹ç™ºã‚’è¡Œã£ã¦ã„ã‚‹WEBã‚·ã‚¹ãƒ†ãƒ ã¯**ROSA**(**Red Hat OpenShift on AWS**/**Kubernetesã‚³ãƒ³ãƒ†ãƒŠãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **)ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

â†“ã®å›³ã«ã‚ã‚‹ã‚ˆã†ã«ã€é–‹ç™ºè€…ãŒè©²å½“ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã—ãŸã‚‰è‡ªå‹•ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ä½œæˆï¼†ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ã‚„ã£ã¦ãã‚Œã‚‹CICDç’°å¢ƒ(Jenkins)ã¨é€£æºã—ã¦ã„ã‚‹å½¢ã§ã™ã€‚

ã“ã‚Œã‚’ã¾ã¨ã‚ã‚‹ã¾ã§ã¯ã€<br>
ãƒ»**OpenShiftå†…ã®ä¸­èº«ãŒãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹çŠ¶æ…‹ã€‚ã©ã†ãªã£ã¦ã‚‹ã‚“ï¼Ÿ**<br>
ãƒ»**ã©ã†ã„ã†æµã‚Œã§ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒä½œã‚‰ã‚Œã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã‚‹ã‚“ï¼Ÿ**<br>
ã¨ã„ã†çŠ¶æ…‹ã ã£ãŸã®ã§ã€å¿˜ã‚Œãªã„ã‚ˆã†è¨˜äº‹ã«æ®‹ã—ã¦ãŠãã¾ã™ã€‚

# ROSAå…¨ä½“åƒ
ç§ãŒé–‹ç™ºã—ã¦ã„ã‚‹WEBã‚·ã‚¹ãƒ†ãƒ ã¯WEBã‚µãƒ¼ãƒ(NodeJS/React)ã¨è¤‡æ•°ã®APIã‚µãƒ¼ãƒ(Java/SpringBoot)ã§æ§‹æˆã•ã‚Œã¦ãŠã‚Šã€ã„ãšã‚Œã‚‚OpenShiftå†…ã§å„ã‚µãƒ¼ãƒ(Pod)ã‚’ç«‹ã¡ä¸Šã’ã¦CloudFrontã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å½¢ã«ãªã£ã¦ã„ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/ab08b5989ab1-20230504.png)

# ROSAã®"Red Hat OpenShift"ã£ã¦ãã‚‚ãã‚‚ä½•ï¼Ÿ
âœ…Red Hatç¤¾ãŒæä¾›ã™ã‚‹Kubernetesãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã€‚<br>
âœ…[Red Hatç¤¾ãŒç›´æ¥æä¾›ã—ã¦ã„ã‚‹ã‚‚ã®](https://www.redhat.com/ja/technologies/cloud-computing/openshift)ã‚’åˆ©ç”¨ã™ã‚‹æ‰‹æ®µãŒã‚ã‚‹ãŒã€ä»–ã‚µãƒ¼ãƒ“ã‚¹ã§æ—¢ã«AWSã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ï¼†ãã‚Œã‚‰ã¨OpenShiftã‚’é€£å‹•ã•ã›ãŸã„(ä¾‹ãˆã°CloudFrontã¨ç´ã¥ã‘ãŸã„)å ´åˆã¯ã€[AWSä¸Šã§åˆ©ç”¨ã§ãã‚‹Red Hat OpenShift](https://ap-northeast-1.console.aws.amazon.com/rosa/home?region=ap-northeast-1#/)ã‚’æ¡ç”¨ã™ã‚‹ã“ã¨ã«ãªã‚‹ï¼ˆç§ã®é–‹ç™ºç¾å ´ã§ã¯ãã†ï¼‰ã€‚

# Kubernetesã«ãªãã¦ã€OpenShiftã«ã‚ã‚‹ã‚‚ã®
ã€Œç´ ã®Kubernetesã«ä¾¿åˆ©æ©Ÿèƒ½ã‚’ä»˜ã‘åŠ ãˆãŸã®ãŒOpenShiftã€ã¿ãŸã„ãªã‚¤ãƒ¡ãƒ¼ã‚¸ãªã®ã§ã€ä»¥ä¸‹ã®è¦ç´ ã¯OpenShiftå›ºæœ‰ã®ç‰¹å¾´ã«ãªã‚‹ã€‚<br>
âœ…Imageãƒ¬ã‚¸ã‚¹ãƒˆãƒªä½œæˆ/é‹ç”¨å¯èƒ½(ImageStream) â€»åˆ¥ã§ãƒ¬ã‚¸ã‚¹ãƒˆãƒªä½œæˆä¸è¦ã ã‹ã‚‰å¬‰ã—ã„<br>
âœ…CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä½œæˆ/é‹ç”¨å¯èƒ½ â€»Jenkinsã§CICDæ§‹æˆã—ã¦ã‚‹å ´åˆã¯ä½¿ã‚ãªã„ã‹ãª<br>
âœ…OpenShiftç‰¹æœ‰ã®ãƒªã‚½ãƒ¼ã‚¹
ã€€â†’ Project/DeploymentConfig/BuildConfig/Route/ImageStream

# ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ™ãƒ³ãƒ€ãƒ¼ãŒæä¾›ã™ã‚‹Kubernetesãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹
ç´ ã®Kubernetesã‚’é‹ç”¨ã™ã‚‹ã«ã¯è¤‡é›‘ã™ãã‚‹ã¨ã„ã†å•é¡Œã‚’è§£æ±ºã—ã¦ãã‚Œã‚‹ã®ãŒã€å„ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ™ãƒ³ãƒ€ãƒ¼ãŒæä¾›ã™ã‚‹Kubernetesãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã€‚Red Hat OpenShiftã¨å«ã‚æ¯”è¼ƒå¯¾è±¡ã¨ãªã‚‹ã‚‚ã®ãŒã“ã¡ã‚‰ã€‚

|ãƒ™ãƒ³ãƒ€ãƒ¼|ã‚µãƒ¼ãƒ“ã‚¹å|
|----|----|
|AWS|EKS(Elastic Kubernetes Service)|
|GCP|GKE(Google Kubernetes Engine)|
|Azure|AKS(Azure Kubernetes Service)|
|Red Hat|**Red Hat OpenShiftâ˜…æœ¬è¨˜äº‹ã®ãƒ¡ã‚¤ãƒ³â˜…**|

â€»AWS ECSã¯AWSã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ãƒ™ãƒ¼ã‚¹ã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ä¸€æ–¹ã§ã€EKSã¯Kubernetesã‚’ãƒ™ãƒ¼ã‚¹ã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ã€‚

ã©ã‚Œã‚’é¸ã¶ã®ã‹ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®è¨˜äº‹ã‚’å‚ç…§ã€‚

https://g3-enterprise.com/2018/10/15/managed-kubernetes/

https://acloudguru.com/blog/engineering/aks-vs-eks-vs-gke-managed-kubernetes-services-compared

# Red Hat OpenShiftã®å„ãƒªã‚½ãƒ¼ã‚¹
OpenShiftç‰¹æœ‰ã®ã‚‚ã®ã¯ğŸ”´
|ãƒªã‚½ãƒ¼ã‚¹å|å†…å®¹|
|----|----|
|RouteğŸ”´|Hostå/SSLã‚µãƒ¼ãƒè¨¼æ˜æ›¸ã‚’è¨­å®šã€‚<br>Scalingã™ã‚‹Podã«SSLã‚µãƒ¼ãƒè¨¼æ˜æ›¸è¨­å®šä¸è¦ğŸ‘|
|Service|PodãŒå†…éƒ¨å…¬é–‹ã—ã¦ã‚‹Portã¨å¤–éƒ¨å…¬é–‹ã™ã‚‹Portã®ç´ã¥ã‘ã€‚|
|Pod|ã‚µãƒ¼ãƒæœ¬ä½“ã€‚|
|DeploymentConfigğŸ”´|å¾Œè¿°ã®ReplicationController, Replicat Setã‚’ç®¡ç†ã€‚|
|Replication Controller|Pod ã®ãƒ¬ãƒ—ãƒªã‚«(è¤‡è£½)æ•°ã‚’ç¶­æŒã™ã‚‹ã€‚|
|Replica Set|å®‰å®šã—ãŸPodã®ã‚»ãƒƒãƒˆã‚’ç¶­æŒã™ã‚‹ã€‚|
|BuildConfigğŸ”´|ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹ã€‚|
|ImageStreamğŸ”´|ä½œæˆã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä¿ç®¡å ´æ‰€/ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã€‚|

![](https://storage.googleapis.com/zenn-user-upload/ab08b5989ab1-20230504.png)

# è² è·åˆ†æ•£
## OpenShiftã«ãŠã‘ã‚‹è² è·åˆ†æ•£
Serviceã§ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°ã™ã‚‹ã€‚
https://docs.openshift.com/container-platform/4.8/networking/configuring_ingress_cluster_traffic/configuring-ingress-cluster-traffic-load-balancer.html#:~:text=OpenShift%20Container%20Platform%20provides%20methods,method%20uses%20a%20load%20balancer.
## AWS EKSã«ãŠã‘ã‚‹è² è·åˆ†æ•£
[AWS Load Balancer Controller](https://github.com/kubernetes-sigs/aws-load-balancer-controller)ã«ã‚ˆã£ã¦**EKSå¤–ã«**[AWS ELB](https://aws.amazon.com/jp/elasticloadbalancing/)ã‚’ä½œæˆã™ã‚‹ã€‚
ãƒ»L4ã§è² è·åˆ†æ•£ã—ãŸã‘ã‚Œã°NLB(Network Load Balancer)
ãƒ»L7ã§è² è·åˆ†æ•£ã—ãŸã‘ã‚Œã°ALB(Application Load Balaner)
ã‚’ä½œæˆã™ã‚‹ã€‚

# ç„¡æ–™ã§ãƒãƒ³ã‚ºã‚ªãƒ³ã§ãã‚‹ã€ŒRed Hat OpenShift Onlineã€
å®Ÿéš›ã«ä½¿ã£ã¦ã¿ãªã„ã¨ã‚ˆãã‚ã‹ã‚“ãªã„ã‚ˆã­ã€ã¨ã„ã†ã“ã¨ã§å¾Œã§ä½¿ã†äºˆå®šã®[Red Hat OpenShift Online](https://www.redhat.com/en/technologies/cloud-computing/openshift/try-it?intcmp=7013a000002D1gVAAS)ã€‚60æ—¥é–“ã¾ã§ç„¡æ–™ã½ã„ã®ã§ã€ã‚ã¨ã§å­¦ç¿’ç”¨ã«ä½¿ã£ã¦ã¿ã‚‹ã€‚

